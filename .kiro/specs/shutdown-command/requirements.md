# Requirements Document

## はじめに
Rustileウィンドウマネージャーにシャットダウン機能を追加する。ユーザーは設定したキーボードショートカットを押すことで、rustileプロセスを終了できる。これにより、ターミナルを開いて手動でプロセスを終了する手間が省ける。終了後、startxで再起動するかどうかはユーザーが選択できる。

## 要件

### 要件1: シャットダウンコマンドの実装
**目的:** ウィンドウマネージャー利用者として、キーボードショートカットでrustileプロセスを終了したい。これにより、ターミナルを開いてプロセス終了コマンドを実行する手間が省ける。

#### 受入基準
1. WHEN ユーザーが設定したシャットダウンキーを押下する THEN Rustileは自身のプロセスを終了する SHALL
2. WHEN シャットダウンコマンドが実行される THEN Rustileは即座に終了する SHALL
3. WHEN シャットダウンが実行される THEN ログに終了メッセージが記録される SHALL

### 要件2: キーバインディング設定
**目的:** ウィンドウマネージャー利用者として、シャットダウンキーを設定ファイルで変更できるようにしたい。これにより、個人の好みや他のアプリケーションとの競合を回避できる。

#### 受入基準
1. WHEN config.tomlに"Shift+Ctrl+Alt+Backspace" = "shutdown"が定義される THEN Rustileはそのキーバインディングを認識する SHALL
2. IF ユーザーが異なるキーコンビネーションを設定する THEN Rustileはそれを受け入れる SHALL
3. WHERE config.exampleファイル内で THE デフォルトのシャットダウンキーバインディング（Shift+Ctrl+Alt+Backspace）が例示される SHALL

### 要件3: エラーハンドリング
**目的:** 開発者として、シャットダウンコマンドの実行状況を把握したい。適切なログ出力により、問題の診断が容易になる。

#### 受入基準
1. WHEN シャットダウンコマンドが実行される THEN ログに終了理由が記録される SHALL
2. WHERE ログファイル内で THE シャットダウンが意図的なユーザー操作によるものと識別できる SHALL

### 要件4: コマンド実装方式
**目的:** 開発者として、既存のコマンドディスパッチシステムとの整合性を保ちたい。これにより、メンテナンス性と拡張性が向上する。

#### 受入基準
1. WHEN "shutdown"コマンドが受信される THEN WindowManagerのコマンドマッチング処理で認識される SHALL
2. IF "shutdown"コマンドが実行される THEN 適切な方法でプロセスを終了する SHALL
3. WHERE WindowManager::handle_key_press()内で THE "shutdown"コマンドが他のウィンドウ管理コマンドと同様に処理される SHALL
